{% from "./form-fields.njk" import activitySpinner %}
{% macro tracking(tracking, csrfToken, show_tracking_giftee=false, show_tracking_actions=false) %}
<div class="mt-8 flex flex-col items-center" id="tracking-details-{{ tracking.tracking_id }}">
  <p>
    {% if show_tracking_actions %}To @{{ tracking.giftee_handle }} on{% else %}Sent{% endif %}
    {{ tracking.shipped_date | ssDate }} with {{ tracking.carrier }} <b>{{ tracking.tracking_number }}</b>. {{ 'Gifts are wrapped.' if tracking.giftwrap_status else  'Gifts are naked (do not remove postal wrapper / box).' }}
  </p>
  {% if show_tracking_actions %}
    <form x-target="tracking-details-{{ tracking.tracking_id }}" action="/player/tracking/{{ tracking.tracking_id }}/{{ 'arrived' if tracking.missing else 'missing' }}" method="post" class="mt-2">
      {{ activitySpinner() }}
      <button class="htmx-request:hidden flex items-center hover:text-sky-500 rounded-xs drop-shadow-lg focus:text-sky-500 focus:ring-3 ring-sky-500 outline-hidden"><div class="{{ 'i-mdi-package-outline' if tracking.missing else 'i-mdi-package-off-outline' }} mr-1 size-5"></div><div>{{ 'Report arrived' if tracking.missing else 'Report missing' }}</div></button>
      <input type="hidden" name="csrfToken" value="{{ csrfToken }}"/>
    </form>
  {% endif %}
</div>
{% endmacro %}
{{ tracking(trackingRecord, csrfToken, show_tracking_giftee, show_tracking_actions) if trackingRecord }}